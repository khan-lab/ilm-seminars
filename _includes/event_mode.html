{%- comment -%}
Renders event mode (in-person / hybrid / remote) with venue and/or online join details.

Usage:
  {% include event_mode.html event=ev %}
Optional flags:
  show_badge: true|false (default true)
  show_join_button: true|false (default true)
{%- endcomment -%}

{%- assign ev = include.event -%}
{%- assign mode = ev.format | default: 'in_person' | downcase -%}
{%- assign show_badge = include.show_badge -%}
{%- if show_badge == nil %}{% assign show_badge = true %}{% endif -%}
{%- assign show_join_button = include.show_join_button -%}
{%- if show_join_button == nil %}{% assign show_join_button = true %}{% endif -%}

{%- capture mode_label -%}
  {%- case mode -%}
    {%- when 'remote' -%}Remote
    {%- when 'hybrid' -%}Hybrid
    {%- else -%}In-person
  {%- endcase -%}
{%- endcapture -%}

<div class="card border-0 shadow-sm mb-3">
  <div class="card-body d-flex flex-column gap-2">

    {%- if show_badge -%}
    <div class="d-flex align-items-center gap-2">
      <span class="badge text-bg-{% if mode == 'remote' %}primary{% elsif mode == 'hybrid' %}warning{% else %}success{% endif %}">
        {% if mode == 'remote' %}<i class="bi bi-camera-video"></i>{% endif %}
        {% if mode == 'hybrid' %}<i class="bi bi-broadcast"></i>{% endif %}
        {% if mode == 'in_person' %}<i class="bi bi-people"></i>{% endif %}
        {{ mode_label | strip }}
      </span>
      {%- if ev.venue and (mode == 'in_person' or mode == 'hybrid') -%}
      <span class="badge rounded-pill text-bg-light">{{ ev.venue }}</span>
      {%- endif -%}
      {%- if ev.remote.platform and (mode == 'hybrid' or mode == 'remote') -%}
      <span class="badge rounded-pill text-bg-light">{{ ev.remote.platform }}</span>
      {%- endif -%}
    </div>
    {%- endif -%}

    {%- if mode == 'in_person' -%}
      {%- if ev.venue -%}
      <div class="text-muted">
        <i class="bi bi-geo-alt"></i>
        <strong>Location:</strong> {{ ev.venue }}
      </div>
      {%- endif -%}
    {%- else -%}
      {%- if ev.remote and ev.remote.url -%}
      <div class="d-flex flex-column flex-sm-row justify-content-between align-items-stretch align-items-sm-center gap-2">
        <div class="text-muted">
          <i class="bi bi-wifi"></i>
          <strong>Online:</strong>
          {%- if ev.remote.platform -%} {{ ev.remote.platform }} • {%- endif -%}
          <a href="{{ ev.remote.url }}" target="_blank" rel="noopener">Join link</a>
          {%- if ev.remote.meeting_id %} &nbsp;·&nbsp; ID: <code>{{ ev.remote.meeting_id }}</code>{% endif -%}
          {%- if ev.remote.passcode %} &nbsp;·&nbsp; Passcode: <code>{{ ev.remote.passcode }}</code>{% endif -%}
          {%- if ev.remote.instructions %}<div class="small text-body-secondary mt-1">{{ ev.remote.instructions }}</div>{% endif -%}
        </div>
        {%- if show_join_button -%}
        <div class="ms-sm-auto">
          <a class="btn btn-primary btn-sm" href="{{ ev.remote.url }}" target="_blank" rel="noopener">
            Join live
          </a>
        </div>
        {%- endif -%}
      </div>
      {%- endif -%}
      {%- if mode == 'hybrid' and ev.venue -%}
      <div class="text-muted">
        <i class="bi bi-geo-alt"></i>
        <strong>On-site:</strong> {{ ev.venue }}
      </div>
      {%- endif -%}
    {%- endif -%}

  </div>
</div>
